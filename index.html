<!DOCTYPE html>
<html>
<head>
    <title>BC Traffic Map</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1.0" />
    <!-- Replace YOUR_API_KEY with your actual API key -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCIzypwXHVm4201GULNbcXz3L1fMPEaouE"></script>
</head>
<body>
<h1>BC Traffic Map</h1>
<!-- The div that will hold the map -->
<div id="map" style="width:100%;height:600px;"></div>
<h1>Select an Area</h1>
<select id="areasDropdown">
    <option value="">--Choose an Area--</option>
</select>
<script>
    // Initialize the Google Map
    function initMap() {
        // A default center in BC, for example Vancouver
        var mapCenter = { lat: 49.2827, lng: -123.1207 };
        var mapOptions = {
            center: mapCenter,
            zoom: 8,
        };

        // Create the map
        var map = new google.maps.Map(document.getElementById("map"), mapOptions);

        // TODO: Fetch data from Open511 and place markers or overlays
    }

    // Call initMap once the page and script load
    window.onload = initMap;

    // Fetch the areas from the Open511 BC API
    fetch("https://api.open511.gov.bc.ca/areas")
        .then(response => response.json())
        .then(data => {
            // The array of areas
            const areas = data.areas;
            const dropdown = document.getElementById("areasDropdown");

            areas.forEach(areaItem => {
                // Create an <option> element for each area
                const option = document.createElement("option");
                // The "value" could be the area ID for filtering
                option.value = areaItem.id;
                // The text displayed to the user could be the name
                option.textContent = areaItem.name;
                dropdown.appendChild(option);
            });
        })
        .catch(error => {
            console.error("Error fetching areas:", error);
        });

    // Listen for user selection
    document.getElementById("areasDropdown").addEventListener("change", (e) => {
        const selectedAreaId = e.target.value;
        console.log("Selected Area ID:", selectedAreaId);

        // If you want to fetch events from this area:
        // fetch("https://api.open511.gov.bc.ca/events?area_id=" + selectedAreaId)
        //   .then(...).then(...);
    });
</script>
</body>
</html>
